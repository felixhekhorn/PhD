Virtual contributions have the same initial and final state as the Born process, but have a looping particle. All contributing Feynman diagrams are depicted in figure \fxerror{do}.
The result can then be written as
\begin{align}
M_k^{(1),V} &= \hat {\mathcal P}_{k}^{\Pgg,\mu\mu'}\hat {\mathcal P}_{k}^{\Pg,\nu\nu'}\sum_{j}\left[\Md^{(1),V}_{j,\mu\nu}\left(\Md^{(0)}_{1,\mu'\nu'}+\Md^{(0)}_{2,\mu'\nu'}\right)^*+c.c.\right] \nonumber\\
 &= 8g^4\mu_D^{-\epsilon}e^2e_H^2 N_C C_FC_\epsilon\left( C_A V_{k,OK} + 2C_F V_{k,QED}\right)
\end{align}
where $C_\epsilon = \exp(\epsilon/2(\gamma_E-\ln(4\pi)))/(16\pi^2)$ and $C_A=N_C$ is the second Casimir constant of the adjoint representation for the gluon (that introduces a non-abelian part).

For the computation of the loops the Passarino-Veltman-decomposition\cite{Passarino:1978jh} in $n=4+\epsilon$ dimension is used as far as possible. The decomposition is based on Lorentz invariance and a good explanation is for example given in \cite{Bojak:2000eu}. The needed scalar integrals are given in \cite{PhysRevD4054} and \cite{Laenen1993162}, but there is also one wrong integral: we find with \cite[Box 16]{Ellis:2007qk}:
\begin{align}
&D_0(m^2,0,q^2,m^2,t,s,0,m^2,m^2,m^2)\nonumber\\
 &=\frac{i C_\epsilon}{\beta s t_1}\left[-\frac{2\ln(\chi)}{\epsilon} -2\ln(\chi)\ln(-t_1/m^2)+\DiLog(1-\chi^2)-4\zeta(2)+\ln^2(\chi_q) + 2\DiLog(-\chi\chi_q)\right.\nonumber\\
 &\hspace{40pt}\left. +2\DiLog(-\chi/\chi_q)+2\ln(\chi\chi_q)\ln(1+\chi\chi_q)+2\ln(\chi/\chi_q)\ln(1+\chi/\chi_q)\right]
\end{align}
where we used the argument ordering of \LoopTools\cite{Hahn:1998yk,LoopTools212Guide} (and also checked it against \LoopTools).

As the short example above shows, the full expressions for the $V_{k,OK},V_{k,QED}$ are quite complicated and too long to be presented here, nevertheless the arising poles are quite compact:
\begin{align}
V_{k,OK} &= -2B_{k,QED}\left(\frac 4 {\epsilon^2} + \left(\ln(-t_1/m^2) + \ln(-u_1/m^2) -\frac{2m^2-s}{s\beta}\ln(\chi)\right)\frac 2 \epsilon \right) + O(\epsilon^0)\\
V_{k,QED} &= -2B_{k,QED}\left(1+\frac{2m^2-s}{s\beta}\ln(\chi)\right)\frac 2 \epsilon + O(\epsilon^0)
\end{align}
The above results already include the mass renormalization that we have performed \textit{on-shell}, so all ultra-violet poles have been removed. For the renormalization of the strong coupling we use the $\MSbar_m$ scheme defined in \cite{Bojak:2000eu} and so the full (remaining) renormalization can be achieved by
\begin{align}
d\sigma_{k}^{(1),V,ren.} &=d\sigma_{k}^{(1),V} + \frac{\alpha_s(\mu_R^2)}{4\pi}\left[\left(\frac 2 \epsilon + \gamma_E-\ln(4\pi)+\ln(\mu_R^2/m^2)-\ln(\mu_D^2/m^2)\right)\beta_0^f \right.\nonumber\\
 &\hspace{120pt}\left.+\frac 2 3 \ln(\mu_R^2/m^2)\right] d\sigma_{k}^{(0)}\\
&=d\sigma_{k}^{(1),V} + 4\pi\alpha_s(\mu_R^2)C_\epsilon\left(\frac{\mu_D^2}{m^2}\right)^{-\epsilon/2}\left[\left(\frac 2 \epsilon +\ln(\mu_R^2/m^2)\right)\beta_0^f \right.\nonumber\\
 &\hspace{180pt}\left.+\frac 2 3 \ln(\mu_R^2/m^2)\right]d\sigma_{k}^{(0)}
\end{align}
with $\mu_R$ the renormalization scale introduced by the renormalization group equation (RGE), $\beta_0^f = (11C_A- 2n_{f})/3$ the first coefficient of the beta function and $n_f$ the number of \textit{total} flavours (i.e. $n_{lf}=n_f-1$ active (light) flavours and one heavy flavour). The double poles occuring in $V_{k,OK}$ are introduced by the diagrams \fxerror{do} when the soft and collinear singularities coincide.

The results agree in the photo-production limit ($q^2\rightarrow 0$) with \cite{Bojak:1998zm} \fxerror{Matrix elements available upon request}.

The procedure is completely analogous to the inclusive case \fxerror{cite}.
